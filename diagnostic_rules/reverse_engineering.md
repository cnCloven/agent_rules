# 逆向工程技术规范 (Reverse Engineering Specifications)

## 1. 文档目标与适用范围
本文件定义了在汽车诊断项目中进行软件逆向工程时的**工具链要求、分析流程规范及文档标准**。
适用于需要分析二进制文件（固件、库、协议实现）以理解工作原理、识别漏洞或实现互操作性的场景。

---

## 2. 工具链要求 (Toolchain Requirements)

在进行逆向分析时，**必须**使用以下类别的专业工具，并确保工具来源可靠、版本更新。

1.  **反汇编/反编译工具**
    *   **核心要求**: 必须支持主流架构（x86/x64, ARM, MIPS等），具备图形化界面、交叉引用、函数识别、数据流分析功能。
    *   **推荐工具**: 
        *   **IDA Pro**: 行业标准，强大的静态分析能力。
        *   **Ghidra**: 开源免费，支持架构广泛，脚本能力强。

2.  **调试器 (Debuggers)**
    *   **核心要求**: 支持用户态和内核态调试，具备断点设置、寄存器查看、内存修改、单步执行功能。
    *   **推荐工具**: 
        *   **GDB**: Linux/嵌入式系统调试首选。
        *   **WinDbg**: Windows 内核/驱动调试首选。
        *   **x64dbg**: Windows 用户态调试强力工具。

3.  **十六进制编辑器 (Hex Editors)**
    *   **核心要求**: 具备文件结构分析、模板解析、数据搜索与Patch功能。
    *   **推荐工具**: 010 Editor, HxD。

4.  **协议与固件分析**
    *   **协议分析**: Wireshark (网络流量), Burp Suite (Web/API)。
    *   **固件分析**: binwalk (固件提取), firmware-mod-kit。

5.  **辅助脚本**
    *   **Python**: 自动化分析、数据处理和工具扩展的首选语言 (如 IDAPython)。

---

## 3. 分析流程规范 (Analysis Process)

逆向工程任务**必须**遵循以下标准化流程，以确保分析的系统性和结果的可验证性。

1.  **目标识别与信息收集 (Reconnaissance)**
    *   明确逆向目标（二进制文件、固件、硬件接口）。
    *   收集指纹信息：哈希值 (MD5/SHA256)、编译时间、版本号、目标平台/架构、依赖库、已知漏洞 (CVE)。

2.  **初步静态分析 (Static Analysis)**
    *   使用 file/strings/binwalk 等工具进行基础扫描。
    *   使用反汇编工具 (IDA/Ghidra) 建立工程，分析导入/导出表 (IAT/EAT)。
    *   识别关键字符串、常量、系统调用，定位关键逻辑入口 (main, init, protocol handlers)。

3.  **动态调试分析 (Dynamic Analysis)**
    *   **环境隔离**: 必须在虚拟机或受控物理设备中运行，严禁在开发机直接运行未知恶意样本。
    *   **行为跟踪**: 使用调试器挂接进程，跟踪执行流程。
    *   **状态监控**: 观察内存变化、寄存器状态、文件/网络 I/O 操作。

4.  **漏洞识别与利用 (Vulnerability Research)**
    *   结合静态逻辑与动态行为，识别潜在漏洞点（缓冲区溢出、逻辑绕过、密钥泄露）。
    *   尝试构造概念验证 (PoC) 以验证漏洞的存在性与可利用性。

5.  **结果产出**
    *   提取算法/协议逻辑，或输出 Patch 后的二进制文件。

---

## 4. 文档与报告标准 (Documentation Standards)

所有逆向分析工作**必须**产出可读文档，禁止只产出代码或二进制结果。

1.  **分析报告 (Analysis Report)**
    *   **目标概述**: 目标的名称、版本、来源。
    *   **分析方法**: 使用的工具、技术路径。
    *   **关键发现**:
        *   代码片段 (反编译代码/汇编)。
        *   内存快照 / 堆栈回溯。
        *   控制流图 (CFG) / 数据流图。
    *   **漏洞详情** (如有): CVE ID (若已有), CVSS 评分, 触发条件, 影响范围。
    *   **修复/兼容建议**: 针对发现的问题提出的具体工程建议。

2.  **代码注释 (Annotation)**
    *   在 IDB/Ghidra 项目文件中，**必须**对识别出的函数、全局变量、结构体成员进行重命名和注释。
    *   注释风格应清晰说明“该函数/变量的业务含义”，而非翻译汇编指令。

3.  **知识库更新**
    *   将提取出的私有协议格式、加密算法常数、特定硬件行为归档至项目知识库，便于团队复用。
