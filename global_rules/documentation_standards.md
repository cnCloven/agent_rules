## 1. 目的与适用范围

本文件规定通用文档的类型、结构与质量要求，覆盖：

- 架构文档（Architecture Docs）  
- API 文档
- 用户手册 / 操作说明（User Manual）

目标：

- 让后续开发者（含 AI Agent）可以**直接通过文档理解系统设计与约束**；
- 降低知识只存于个人或代码中的风险。

---

## 2. 文档目录与格式要求

### 2.1 建议目录结构

建议建立 `doc` 目录：

```text
doc/
   ├─ architecture/
   ├─ api/
   └─ user/
```

- `architecture/`：架构文档（整体设计、模块说明、决策记录等）
- `api/`：面向外部/内部调用方的 API 说明
- `user/`：面向使用者（测试/服务技师/集成人员）的用户手册

### 2.2 基本格式

- 默认格式：**Markdown (`.md`)**  
- 编码：UTF-8  
- 文本结构：
  - 使用 `#`/`##`/`###` 标题层级；
  - 使用有序/无序列表清晰列出要点；
  - 代码示例使用代码块 ``` ```；
  - 关键约束可使用 **MUST/MUST NOT/SHOULD/MAY** 等术语。

---

## 3. 通用写作规范

### 3.1 语言与术语

- 主体语言：**简体中文**；
- 专有名词：保留英文缩写/术语并在首次出现时简要说明。
- 避免主观形容词（例如“非常快”、“特别复杂”），使用**可验证描述**。

### 3.2 版本与追踪

每份文档头部 MUST 包含：

```markdown
- Version: x.y.z
- Status: Draft / Review / Approved
- Last Updated: YYYY-MM-DD
- Owner: <role or team>
- Related Code: path/to/files or modules
```

变更需通过 Git 记录，重要文档变化应简要写在“Changelog”段落。

### 3.3 面向 AI Agent 的可读性

- 明确分节与小标题，避免长段落；
- 关键约束用列表或 Checklist 表达；
- 避免过多图片/手绘图依赖，必须有**文字化描述**的架构与流程。

### 3.4 变更记录
- 每次架构调整（如新增模块、修改接口），必须同步更新设计文档。
- 文档头部需包含 `Change Log` 表格：版本、日期、作者、变更摘要。

---

## 4. 架构文档规范（Architecture Docs）

### 4.1 目标与读者

- 读者：架构师、高级开发、AI Agent、评审方；
- 目标：用**有限文字**清楚说明：
  - 工程如何组织（目录/模块/分层）；
  - 模块交互关系；
  - 为何采用当前架构，关键设计决策是什么。

### 4.2 必备文档列表

建议至少包含以下文件：

- `doc/architecture/overview.md`  
- `doc/architecture/modules.md`  
- `doc/architecture/data_model.md`  
- `doc/architecture/decisions.md`（架构决策记录 / ADR）

### 4.3 内容要求

- **系统上下文**：文字化描述软件与外部实体的关系。
- **分层架构说明**：描述各层职责与依赖方向。
- **模块职责**：描述主要模块的职责、输入输出。
- **ADR**：记录关键决策的背景、决定和后果。

---

## 5. API 文档规范

### 5.1 目标

- 为调用方（包括其他模块、集成方、AI Agent）提供**清晰可靠的接口说明**；
- 尤其对错误处理、线程安全、生命周期给出明确约束。

### 5.2 位置与形式

- API 文档主要通过：
  - **头文件中的 Doxygen 风格注释**；
  - `doc/api/*.md` 的**概览文档**（列出主要接口、调用示意）。

### 5.3 注释规范

每个对外公开的类/函数 MUST：

- 说明用途（What & Why）；
- 说明参数、返回值、错误码；
- 标记线程安全与使用约束。

---

## 6. 用户手册规范（User Manual）

### 6.1 目标与读者

- 读者：测试工程师、操作人员、集成工程师；
- 内容：**如何正确、安全地使用软件功能**，而不是内部技术实现细节。

### 6.2 基本结构

1. **简介**：软件用途、主要功能概览。
2. **环境准备**：OS、依赖、权限。
3. **安装与升级**：安装步骤、升级注意事项。
4. **主要功能操作步骤**：步骤化说明。
5. **故障诊断与排错**：常见错误代码解释与建议。

---

## 7. 最小文档集与质量检查

为每个准备发布的版本，至少应具备并更新：

- [ ] `doc/architecture/overview.md`
- [ ] `doc/architecture/modules.md`
- [ ] `doc/api/overview.md`
- [ ] `doc/user/user_guide.md`

AI Agent 在生成/修改上述文档时，应：

- 按本规范结构组织内容；
- 显式标注版本信息与适用范围；
- 在涉及接口时，优先与已有代码保持一致，如有假设需明确说明。
