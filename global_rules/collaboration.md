## 1. 文档用途与适用范围

本文件是对 **AI Agent** 的约束，专门用于指导你在生成以下内容时的行为：

- 项目计划、里程碑规划
- 任务拆分列表（Backlog / TODO）
- 协作方式说明、流程说明
- 技术债务清单
- 知识库/文档维护相关说明

目标：确保 Agent 输出的协作文档具备**可执行性、原子性与可追踪性**，便于人类团队成员直接理解与执行。
你在输出任何“项目管理 / 团队协作 / 计划类文档”时，**必须遵守本文件**。

---

## 2. 任务拆分与计划输出规则

### 2.1 拆分层级（你在文档中应怎么组织）

当需要拆任务或写计划时，默认使用三层结构：

- **Epic**：大的目标或阶段（可选）
- **Story / Feature**：可在 1–2 周内完成的功能块
- **Task**：0.5–2 人日的具体开发/测试/文档工作

输出格式示例（推荐）：

```markdown
## Epic: 基础功能模块

### Story: 支持基础数据读写

- Task: 设计模块接口（domain 层）
- Task: 实现读取逻辑与解析
- Task: 实现错误处理
- Task: 编写单元测试
- Task: 更新文档
```

### 2.2 对每个 Task 必须输出的最小信息

当你列出 Task 时，尽量包含以下字段（简洁即可）：

- **Title**：任务标题（短语）
- **Goal**：想解决什么问题
- **Scope**：做什么 / 不做什么（如信息不足可写“需补充”）
- **Artifacts**：预期产出（代码/测试/文档路径）
- **Dependencies**：前置条件或依赖任务（如有）

示例：

```markdown
- Task: 实现会话状态机
  - Goal: 支持状态切换
  - Scope: 仅实现 domain 层状态机，不含 UI 逻辑
  - Artifacts: `code/domain/session_manager.*`
  - Dependencies: Transport 接口已定义
```

如果用户没有时间维度要求，你**不要**擅自给出具体日期，只按逻辑顺序/优先级排序即可。

---

## 3. 协作与沟通相关文档的写法

当用户让你输出“团队协作方式”、“沟通机制”、“开发流程说明”等内容时：

1. **使用简短分节 + 列表**，避免长文：
   - 如：`沟通渠道`、`评审方式` 等小节。
2. **避免制定过细的管理制度**：
   - 只给出**工程上必要的约束**，例如：
     - “合并到 develop 必须通过 CI + Code Review”
     - “接口变更必须更新对应文档”
3. **不要虚构具体人员/组织结构**：
   - 可以使用角色名，如 `架构师 / 模块负责人 / 开发 / 测试`；
   - 不要假设具体人名或公司流程。

输出示例结构：

```markdown
## 沟通与决策记录

- 架构/协议重大变更：
  - 建议：先产出简短设计文档草稿（由你生成），再评审。
- 日常问题：
  - 建议：在 Issue/任务系统中记录结论，不仅停留在聊天工具。
```

---

## 4. 技术债务管理输出规则

当需要描述或整理“技术债务”时，你应：

### 4.1 明确分类（简单四类）

在输出技术债时，使用以下分类字段之一：

- `Architecture`：架构/分层/模块边界问题
- `Code`：命名差、重复代码、无错误处理等
- `Test`：测试不足、覆盖率低
- `Doc`：文档缺失或与实现不符

### 4.2 每条技术债的最小信息

每条条目建议包含：

- **Type**：上述四类之一
- **Description**：简要描述问题
- **Impact**：高/中/低（描述为什么有风险，如影响稳定性/维护成本）
- **Suggested Fix**：简短的修复思路（不展开到实现细节）

示例：

```markdown
- [TechDebt] Type=Architecture
  - Description: 模块 A 直接访问模块 B 内部，未通过接口。
  - Impact: 中 —— 增加耦合，不利于未来替换实现。
  - Suggested Fix: 引入接口，重定向依赖。
```

### 4.3 当你给出“临时方案”时的要求

如果你在回答中给出“权宜之计”或“先这样实现”的建议，**必须**同步标注一条技术债，并简单说明后续应如何优化，而不是只留下临时实现。

---

## 5. 知识库与文档引用规则

当你生成涉及“文档/知识库/说明书”的内容时：

### 5.1 默认目录与文件约定

你应优先引用前面文档中已经约定的目录。
**不要**自行创造全新目录层级，除非用户明确要求。

### 5.2 引用方式

在计划或协作文档中引用其他文档时，推荐使用简短路径+用途说明：

```markdown
- 相关文档：
  - `doc/architecture/overview.md`：整体架构说明
```

### 5.3 文档更新提示

当你设计一个变更会影响接口或协议行为时，在回答中**主动提醒**：

- “需要同步更新文档：`doc/api/xxx.md`”

不需要自己真的写出全部文档内容，除非用户让你生成。

---

## 6. 输出风格：针对项目管理类内容的特别要求

当你生成项目管理 / 协作相关内容时，应遵守：

1. **结构化优先**  
   - 使用标题（`##`）、子标题、列表，而不是大段自然语言；
   - 适合复制到任务系统/Wiki 中。

2. **避免时间表细化到具体日期**  
   - 除非用户给出具体日程，否则用“第 N 周”“阶段 1/2/3”描述即可。

3. **少谈“公司制度”，多谈“工程实践”**  
   - 比如：“合并前需要 Code Review + CI 通过”，而不是“强制 KPI”“考核”。

4. **保持与已有规则一致**  
   - 提到 Git 流程、测试要求、文档要求时，需与 `global_rules` 中的内容一致。

---

## 7. 自检清单（你在生成协作/计划类输出前后自查）

在输出任何“项目/计划/协作/流程”相关回答时，快速自检：

- [ ] 是否将任务拆分到**可执行的 Task 级**（0.5–2 人日）？
- [ ] 是否清楚说明了每个 Task 的目标和产出（代码/测试/文档）？  
- [ ] 是否在给出临时方案时**同步标注了技术债**？  
- [ ] 是否引用或对齐了已有文档约定？  
- [ ] 是否使用了结构化、小节 + 列表的方式，便于复制到任务系统/文档中？

只要满足以上点，你生成的项目管理类内容就被视为**符合本协作准则**。
